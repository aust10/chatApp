(this["webpackJsonpclient-react"]=this["webpackJsonpclient-react"]||[]).push([[0],{50:function(e,t,n){e.exports=n(90)},55:function(e,t,n){},83:function(e,t){},90:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),s=n(48),l=n.n(s),r=(n(55),n(14)),m=n(15),i=n(17),u=n(16),c=n(27),h=n.n(c),d=n(1);function g(e){return o.a.createElement("li",{className:"message-item"},o.a.createElement("span",{className:"date"},new Date(e.message.date).toLocaleString()),o.a.createElement("span",{className:"nick"}," ",e.message.user.username,": "),o.a.createElement("span",{className:"text"},e.message.text," "),e.message.user.username===e.username?o.a.createElement("span",{className:"del"},o.a.createElement("button",{onClick:function(){return e.del(e.message)}},"Delete")):null)}var p=function(e){Object(i.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={form:"",messages:a.props.messages,formValue:"",room:""},a}return Object(m.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.match.params.room;this.setState({room:e})}},{key:"sendMessage",value:function(e){e.preventDefault();var t={text:this.state.formValue,username:this.props.username,room:this.state.room,date:new Date,token:this.props.token};this.props.handleSubmit(t)}},{key:"handleChangeFormInput",value:function(e){this.setState({formValue:e.target.value})}},{key:"deleteMessage",value:function(e){console.log(e);var t={text:e.text,user:e.user._id};console.log(t,"this is del content line 54"),this.props.handleDelete(t)}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{id:"chatroom"},o.a.createElement("h1",null,this.state.room),o.a.createElement("div",{id:"chatbox"},o.a.createElement("ul",{id:"messages"},this.props.messages.filter((function(t){return t.room===e.state.room})).map((function(t,n){return o.a.createElement(g,{message:t,key:n,del:e.deleteMessage.bind(e),username:e.props.username})})))),o.a.createElement("br",null),o.a.createElement("form",{id:"send-message",onSubmit:this.sendMessage.bind(this)},o.a.createElement("input",{id:"message-text",type:"text",placeholder:"message...",value:this.formValue,onChange:this.handleChangeFormInput.bind(this)}),o.a.createElement("button",{type:"submit"},"Send")))}}]),n}(o.a.Component),E=Object(d.h)(p);function b(e){var t=Object(d.g)();return o.a.createElement("div",{id:"rooms"},e.loggedIn?o.a.createElement("h1",null,"Hi ",e.username,"!"):o.a.createElement("h1",null,"Please log in."),o.a.createElement("button",{onClick:function(){var e=prompt("Enter a room name");t.push("/rooms/".concat(e))}},"Add Room"),o.a.createElement("br",null),o.a.createElement("label",{htmlFor:"room-select"},"Change Room: "),o.a.createElement("select",{onChange:function(e){var n=e.target.value;t.push("/rooms/".concat(n)),console.log(t,"this is history")},name:"room",id:"room-select",value:e.room},o.a.createElement("option",{value:""},"--Select a Room--"),e.rooms.map((function(e){return o.a.createElement("option",{key:e,value:e},e)}))))}function f(e){return o.a.createElement("div",{id:"chatroom"},o.a.createElement("form",{onSubmit:e.onHandle},o.a.createElement("label",null,"Username:"),o.a.createElement("input",{type:"text",id:"username"}),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("label",null,"Password:"),o.a.createElement("input",{type:"password",id:"password"}),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("input",{type:"submit",value:"submit",key:"submit",id:"submitButton"})))}function v(e){return o.a.createElement("div",{id:"chatroom"},o.a.createElement("form",{onSubmit:e.onHandle},o.a.createElement("label",null,"Username:"),o.a.createElement("input",{type:"text",id:"username"}),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("label",null,"Password:"),o.a.createElement("input",{type:"password",id:"password"}),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("input",{type:"submit",value:"submit",key:"submit",id:"submitButton"})))}function y(e){return Object(d.g)().push("/"),o.a.createElement("div",{id:"chatroom"},o.a.createElement("h1",null,"Welcome"),o.a.createElement("form",{onSubmit:e.onHandle},o.a.createElement("label",null,"Username"),o.a.createElement("input",{type:"text",id:"nickname"}),o.a.createElement("label",null,"Password"),o.a.createElement("input",{type:"password"}),o.a.createElement("input",{type:"submit",value:"submit",key:"submit"})))}var k=n(6),S=h()(),w=function(e){Object(i.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={messages:[],room:"",formValue:"",loggedIn:!1,username:"",token:""},a}return Object(m.a)(n,[{key:"componentDidMount",value:function(){var e=this;S.on("chat message",(function(t){console.log("Got a message:",t),e.setState({messages:e.state.messages.concat(t)})}))}},{key:"handleLogin",value:function(e){var t=this;e.preventDefault();var n=document.getElementById("username").value,a=document.getElementById("password").value;console.log(n,"this is the username"),fetch("/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,password:a})}).then((function(e){return e.json()})).then((function(e){t.setState({token:e.token,username:e.username,loggedIn:!0},(function(){console.log(t.state,"this is the states username"),fetch("/messages",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.state.token)}}).then((function(e){return e.json()})).then((function(e){return t.setState({messages:e},(function(){console.log(e,"this is the data we are getting on login")}))}))}))}))}},{key:"handleSignUp",value:function(e){var t=this;e.preventDefault();var n=document.getElementById("username").value,a=document.getElementById("password").value;fetch("/sign-up",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,password:a})}).then((function(e){return e.json()})).then((function(e){t.setState({token:e.token,username:e.username,loggedIn:!0},(function(){fetch("/messages",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.state.token)}}).then((function(e){return e.json()})).then((function(e){return t.setState({messages:e},(function(){console.log(e,"this is the data we are getting on login")}))}))})),console.log(t.state)}))}},{key:"handleLogOut",value:function(){this.setState({loggedIn:!1,username:"",messages:[],room:"",formValue:"",token:""})}},{key:"handleSubmit",value:function(e){S.emit("chat message",e)}},{key:"handleDelete",value:function(e){var t=this;console.log(e,"this is del content line 140"),fetch("/messages",{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.state.token)},body:JSON.stringify(e)}).then((function(e){return console.log(e)})),fetch("/messages",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.state.token)}}).then((function(e){return e.json()})).then((function(e){return t.setState({messages:e},(function(){console.log(e,"this is the data we are getting on delete")}))}))}},{key:"getRooms",value:function(){var e=this.state.messages.map((function(e){return e.room}));e.push(this.state.room);var t=e.filter((function(e){return e}));return Array.from(new Set(t))}},{key:"render",value:function(){return o.a.createElement(k.a,null,o.a.createElement("div",null,o.a.createElement("nav",null,this.state.loggedIn?o.a.createElement("div",null,o.a.createElement("span",{className:"linkTo"},o.a.createElement(k.b,{to:"/"},o.a.createElement("button",{type:"button"},"Back"))),o.a.createElement("span",{className:"linkTo",onClick:this.handleLogOut.bind(this)},o.a.createElement(k.b,{to:"/logout"},o.a.createElement("button",{type:"button"},"Logout")))):o.a.createElement("div",null,o.a.createElement("span",{className:"linkTo"},o.a.createElement(k.b,{to:"/"},o.a.createElement("button",{type:"button"},"Home"))),o.a.createElement("span",{className:"linkTo"},o.a.createElement(k.b,{to:"/login"},o.a.createElement("button",{type:"button"},"Login"))),o.a.createElement("span",{className:"linkTo"},o.a.createElement(k.b,{to:"/signup"},o.a.createElement("button",{type:"button"},"Signup"))))),o.a.createElement("div",{id:"main-wrap"},o.a.createElement(d.d,null,o.a.createElement(d.b,{path:"/rooms/:room"},o.a.createElement(E,{messages:this.state.messages,room:this.state.room,formValue:this.state.formValue,username:this.state.username,token:this.state.token,handleSubmit:this.handleSubmit.bind(this),handleDelete:this.handleDelete.bind(this)})),o.a.createElement(d.b,{path:"/login"},o.a.createElement("h1",null,"Login"),o.a.createElement(f,{onHandle:this.handleLogin.bind(this)}),this.state.loggedIn?o.a.createElement(d.a,{to:{pathname:"/"}}):null),o.a.createElement(d.b,{path:"/logout"},o.a.createElement("h1",null,"Logged Out"),o.a.createElement(y,null)),o.a.createElement(d.b,{path:"/signup"},o.a.createElement("h1",null,"Sign-Up"),o.a.createElement(v,{onHandle:this.handleSignUp.bind(this)}),this.state.loggedIn?o.a.createElement(d.a,{to:{pathname:"/login"}}):null),o.a.createElement(d.b,{path:"/"},o.a.createElement("h1",null,"Welcome to the Project Chat Homepage"),this.state.loggedIn?o.a.createElement(b,{loggedIn:this.state.loggedIn,username:this.state.username,room:this.state.room,rooms:this.getRooms()}):o.a.createElement("h1",null,"Please log in."))))))}}]),n}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(k.a,null,o.a.createElement(w,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[50,1,2]]]);
//# sourceMappingURL=main.fa14cbd7.chunk.js.map